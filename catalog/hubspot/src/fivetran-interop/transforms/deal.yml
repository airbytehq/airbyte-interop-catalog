domain: hubspot.fivetran-interop
transforms:
  - name: deal
    from:
      - deals: hubspot.deals
    fields:
      deal_id:
        expression: deals.id
        description: The ID of the deal.
      is_deleted:
        expression: deals.archived
        description: Whether the record was deleted.
      portal_id:
        expression: MISSING
        description: '{{ doc("portal_id") }}'
      deal_pipeline_id:
        expression: deals.properties.pipeline
        description: The ID of the deal's pipeline.
      deal_pipeline_stage_id:
        expression: deals.properties.dealstage
        description: The ID of the deal's pipeline stage.
      owner_id:
        expression: deals.properties.hs_all_owner_ids
        description: The ID of the deal's owner.
      property_dealname:
        expression: deals.properties.dealname
        description: The name you have given this deal.
      property_description:
        expression: deals.properties.description
        description: A brief description of the deal.
      property_amount:
        expression: deals.properties.amount
        description: The total value of the deal in the deal's currency.
      property_closedate:
        expression: deals.properties.closedate
        description: The day the deal is expected to close, or was closed.
      property_createdate:
        expression: deals.properties.createdate
        description:
          The date the deal was created. This property is set automatically
          by HubSpot.
annotations:
  approved: true
  missing_fields:
    - portal_id
  evaluation:
    source_stream_name: deals
    target_table_name: deal
    name_match_score: 0.85
    score: 0.727
    explanation:
      The overall confidence score is 0.727, indicating a generally good
      match with some areas of uncertainty. The field 'portal_id' has a missing expression,
      lowering the overall confidence. Most fields have a strong match to their expressions,
      but a few mappings are predicted to refer to potentially different concepts,
      capping the score at 0.7 for those fields.
    field_mapping_evals:
      - name: deal_id
        expression: deals.id
        score: 1.0
        explanation: Perfect match with 'deals.id', clear and distinct relationship.
      - name: is_deleted
        expression: deals.archived
        score: 1.0
        explanation: Perfect match with 'deals.archived', clear and distinct relationship.
      - name: portal_id
        expression: MISSING
        score: 0.0
        explanation: Missing expression, confidence is null.
      - name: deal_pipeline_id
        expression: deals.properties.pipeline
        score: 0.7
        explanation:
          Good match but might refer to different pipeline stages, capping
          at 0.7.
      - name: deal_pipeline_stage_id
        expression: deals.properties.dealstage
        score: 0.7
        explanation:
          Good match but might refer to different pipeline stages, capping
          at 0.7.
      - name: owner_id
        expression: deals.properties.hs_all_owner_ids
        score: 0.7
        explanation:
          Good match but might refer to different owner specifications,
          capping at 0.7.
      - name: property_dealname
        expression: deals.properties.dealname
        score: 1.0
        explanation:
          Perfect match with 'deals.properties.dealname', clear and distinct
          relationship.
      - name: property_description
        expression: deals.properties.description
        score: 1.0
        explanation:
          Perfect match with 'deals.properties.description', clear and
          distinct relationship.
      - name: property_amount
        expression: deals.properties.amount
        score: 1.0
        explanation:
          Perfect match with 'deals.properties.amount', clear and distinct
          relationship.
      - name: property_closedate
        expression: deals.properties.closedate
        score: 1.0
        explanation:
          Perfect match with 'deals.properties.closedate', clear and distinct
          relationship.
      - name: property_createdate
        expression: deals.properties.createdate
        score: 1.0
        explanation:
          Perfect match with 'deals.properties.createdate', clear and distinct
          relationship.
