domain: hubspot.fivetran-interop
transforms:
  - name: email_subscription_change
    from:
      - subscription_changes: hubspot.subscription_changes
    fields:
      _fivetran_synced:
        expression: subscription_changes._airbyte_extracted_at
        description: '{{ doc("_fivetran_synced") }}'
      caused_by_event_id:
        expression: MISSING
        description: The ID of the event that caused the subscription change.
      change:
        expression: MISSING
        description:
          The change which occurred. This enumeration is specific to the
          'changeType'; see below for the possible values.
      change_type:
        expression: MISSING
        description: The type of change which occurred.
      email_subscription_id:
        expression: MISSING
        description: The ID of the related email subscription.
      portal_id:
        expression: subscription_changes.portalId
        description: '{{ doc("portal_id") }}'
      recipient:
        expression: subscription_changes.recipient
        description: The email address of the related contact.
      source:
        expression: MISSING
        description: The source of the subscription change.
      timestamp:
        expression: subscription_changes.timestamp
        description:
          The timestamp when this change occurred. If 'causedByEvent' is
          present, this will be absent.
annotations:
  approved: false
  missing_fields:
    - caused_by_event_id
    - change
    - change_type
    - email_subscription_id
    - source
  evaluation:
    source_stream_name: subscription_changes
    target_table_name: email_subscription_change
    table_match_score: 0.65
    completion_score: 0.25
    explanation:
      The table match score indicates a moderate level of confidence that
      the source and target tables describe similar subject matter. The completion
      score is low due to multiple 'MISSING' expressions for field mappings, which
      suggests incomplete mappings.
    field_mapping_evals:
      - name: _fivetran_synced
        expression: subscription_changes._airbyte_extracted_at
        score: 1.0
        explanation:
          "Standard mapping rule applied: '_fivetran_synced' is always
          mapped to '_airbyte_extracted_at'. No penalty or reward."
      - name: caused_by_event_id
        expression: MISSING
        score: 0.0
        explanation: No good match found.
      - name: change
        expression: MISSING
        score: 0.0
        explanation: No good match found.
      - name: change_type
        expression: MISSING
        score: 0.0
        explanation: No good match found.
      - name: email_subscription_id
        expression: MISSING
        score: 0.0
        explanation: No good match found.
      - name: portal_id
        expression: subscription_changes.portalId
        score: 0.65
        explanation: Mapping is considered likely since 'portal_id' matches 'subscription_changes.portalId'.
      - name: recipient
        expression: subscription_changes.recipient
        score: 0.65
        explanation: Mapping is considered likely since 'recipient' matches 'subscription_changes.recipient'.
      - name: source
        expression: MISSING
        score: 0.0
        explanation: No good match found.
      - name: timestamp
        expression: subscription_changes.timestamp
        score: 0.65
        explanation: Mapping is considered likely since 'timestamp' matches 'subscription_changes.timestamp'.
