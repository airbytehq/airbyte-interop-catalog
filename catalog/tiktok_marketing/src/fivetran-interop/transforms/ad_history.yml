domain: tiktok_marketing.fivetran-interop
transforms:
  - name: ad_history
    from:
      - ads: tiktok_marketing.ads
    fields:
      ad_id:
        expression: ads.ad_id
        description: Ad ID
      updated_at:
        expression: ads._airbyte_extracted_at
        description: Time the record was updated.
      adgroup_id:
        expression: ads.adgroup_id
        description: Ad group ID
      advertiser_id:
        expression: ads.advertiser_id
        description: Advertiser ID
      campaign_id:
        expression: ads.campaign_id
        description: Campaign ID
      ad_name:
        expression: ads.ad_name
        description: Ad Name.
      ad_text:
        expression: ads.ad_text
        description: The ad text.
      app_name:
        expression: ads.app_name
        description: The display name of app download ad.
      call_to_action:
        expression: ads.call_to_action
        description: Call to action values.
      click_tracking_url:
        expression: ads.click_tracking_url
        description: Click monitoring URL.
      create_time:
        expression: ads.create_time
        description: Time at which the ad was created.
      display_name:
        expression: ads.display_name
        description: The display name of landing page or pure exposure ad.
      image_ids:
        expression: ads.image_ids
        description: A list of image IDs.
      impression_tracking_url:
        expression: ads.impression_tracking_url
        description: Display monitoring URL.
      is_aco:
        expression: ads.is_aco
        description: Whether the ad is an automated ad.
      is_creative_authorized:
        expression: ads.creative_authorized
        description:
          "Whether you grant displaying some of your ads in our TikTok
          For Business Creative Center. Only valid for non-US advertisers, the default
          value is false.\n"
      is_new_structure:
        expression: ads.is_new_structure
        description: Whether the campaign is a new structure.
      landing_page_url:
        expression: ads.landing_page_url
        description: Landing page URL.
      open_url:
        expression: ads.deeplink
        description:
          The specific location where you want your audience to go if they
          have your app installed.
      opt_status:
        expression: ads.operation_status
        description: Operation status.
      playable_url:
        expression: ads.playable_url
        description: Playable material url.
      profile_image:
        expression: ads.profile_image_url
        description: Avatar URL.
      status:
        expression: ads.secondary_status
        description: Ad status.
      video_id:
        expression: ads.video_id
        description: The video ID.
annotations:
  approved: true
  missing_fields: []
  evaluation:
    source_stream_name: ads
    target_table_name: ad_history
    name_match_score: 0.9
    score: 0.85
    explanation:
      Overall evaluation indicates high confidence in field mapping based
      on the descriptive correlation between field names and the expressions. Consistent
      naming practices and clear, specific field descriptions contributed significantly
      to the mapping confidence.
    field_mapping_evals:
      - name: ad_id
        expression: ads.ad_id
        score: 0.95
        explanation: High confidence as 'ad_id' maps precisely to 'ads.ad_id'.
      - name: updated_at
        expression: ads._airbyte_extracted_at
        score: 0.9
        explanation:
          Field 'updated_at' correctly maps to 'ads._airbyte_extracted_at'
          as expected for `_fivetran_synced` mappings.
      - name: adgroup_id
        expression: ads.adgroup_id
        score: 0.95
        explanation: Mapping of 'adgroup_id' to 'ads.adgroup_id' is precise and clear.
      - name: advertiser_id
        expression: ads.advertiser_id
        score: 0.95
        explanation: Exact mapping to 'ads.advertiser_id' ensures high confidence.
      - name: campaign_id
        expression: ads.campaign_id
        score: 0.95
        explanation: Direct, clear mapping to 'ads.campaign_id'.
      - name: ad_name
        expression: ads.ad_name
        score: 0.9
        explanation: Field 'ad_name' accurately matches 'ads.ad_name'.
      - name: ad_text
        expression: ads.ad_text
        score: 0.9
        explanation: Clear match between 'ad_text' and 'ads.ad_text'.
      - name: app_name
        expression: ads.app_name
        score: 0.85
        explanation: Matches 'ads.app_name' appropriately, indicating good confidence.
      - name: call_to_action
        expression: ads.call_to_action
        score: 0.8
        explanation: Mapping of 'call_to_action' shows strong correlation with 'ads.call_to_action'.
      - name: click_tracking_url
        expression: ads.click_tracking_url
        score: 0.85
        explanation: Good mapping confidence with 'ads.click_tracking_url'.
      - name: create_time
        expression: ads.create_time
        score: 0.9
        explanation: Accurate alignment with 'ads.create_time'.
      - name: display_name
        expression: ads.display_name
        score: 0.85
        explanation: Well-mapped to 'ads.display_name'.
      - name: image_ids
        expression: ads.image_ids
        score: 0.85
        explanation: Properly matches 'ads.image_ids'.
      - name: impression_tracking_url
        expression: ads.impression_tracking_url
        score: 0.85
        explanation: Correctly mapped to 'ads.impression_tracking_url'.
      - name: is_aco
        expression: ads.is_aco
        score: 0.8
        explanation: Mapping has strong correlation to 'ads.is_aco'.
      - name: is_creative_authorized
        expression: ads.creative_authorized
        score: 0.8
        explanation: Confident mapping to 'ads.creative_authorized'.
      - name: is_new_structure
        expression: ads.is_new_structure
        score: 0.8
        explanation: Good confidence in mapping to 'ads.is_new_structure'.
      - name: landing_page_url
        expression: ads.landing_page_url
        score: 0.8
        explanation: Strong association with 'ads.landing_page_url'.
      - name: open_url
        expression: ads.deeplink
        score: 0.75
        explanation: Good confidence mapping to 'ads.deeplink'.
      - name: opt_status
        expression: ads.operation_status
        score: 0.8
        explanation: Strong similarity with 'ads.operation_status'.
      - name: playable_url
        expression: ads.playable_url
        score: 0.75
        explanation: Adequate match with 'ads.playable_url'.
      - name: profile_image
        expression: ads.profile_image_url
        score: 0.75
        explanation: Reasonable confidence mapping to 'ads.profile_image_url'.
      - name: status
        expression: ads.secondary_status
        score: 0.75
        explanation: Good mapping with 'ads.secondary_status'.
      - name: video_id
        expression: ads.video_id
        score: 0.85
        explanation: Proper mapping with high confidence to 'ads.video_id'.
