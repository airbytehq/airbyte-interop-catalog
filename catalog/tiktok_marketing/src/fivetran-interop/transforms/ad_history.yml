domain: tiktok_marketing.fivetran-interop
transforms:
  - name: ad_history
    from:
      - ads: tiktok_marketing.ads
    fields:
      ad_id:
        expression: ads.ad_id
        description: Ad ID
      updated_at:
        expression: ads._airbyte_extracted_at
        description: Time the record was updated.
      adgroup_id:
        expression: ads.adgroup_id
        description: Ad group ID
      advertiser_id:
        expression: ads.advertiser_id
        description: Advertiser ID
      campaign_id:
        expression: ads.campaign_id
        description: Campaign ID
      ad_name:
        expression: ads.ad_name
        description: Ad Name.
      ad_text:
        expression: ads.ad_text
        description: The ad text.
      app_name:
        expression: ads.app_name
        description: The display name of app download ad.
      call_to_action:
        expression: ads.call_to_action
        description: Call to action values.
      click_tracking_url:
        expression: ads.click_tracking_url
        description: Click monitoring URL.
      create_time:
        expression: ads.create_time
        description: Time at which the ad was created.
      display_name:
        expression: ads.display_name
        description: The display name of landing page or pure exposure ad.
      image_ids:
        expression: ads.image_ids
        description: A list of image IDs.
      impression_tracking_url:
        expression: ads.impression_tracking_url
        description: Display monitoring URL.
      is_aco:
        expression: ads.is_aco
        description: Whether the ad is an automated ad.
      is_creative_authorized:
        expression: ads.creative_authorized
        description:
          "Whether you grant displaying some of your ads in our TikTok
          For Business Creative Center. Only valid for non-US advertisers, the default
          value is false.\n"
      is_new_structure:
        expression: ads.is_new_structure
        description: Whether the campaign is a new structure.
      landing_page_url:
        expression: ads.landing_page_url
        description: Landing page URL.
      open_url:
        expression: ads.deeplink
        description:
          The specific location where you want your audience to go if they
          have your app installed.
      opt_status:
        expression: ads.operation_status
        description: Operation status.
      playable_url:
        expression: ads.playable_url
        description: Playable material url.
      profile_image:
        expression: ads.profile_image_url
        description: Avatar URL.
      status:
        expression: ads.secondary_status
        description: Ad status.
      video_id:
        expression: ads.video_id
        description: The video ID.
annotations:
  approved: true
  missing_fields: []
  evaluation:
    source_stream_name: ads
    target_table_name: ad_history
    table_match_score: 0.85
    completion_score: 0.95
    explanation:
      The table mapping reflects a high degree of confidence given that
      the field mappings align well with expectations for a typical ad schema. However,
      some fields could not perfectly be matched or verified due to lack of comprehensive
      context.
    field_mapping_evals:
      - name: ad_id
        expression: ads.ad_id
        score: 1.0
        explanation: Perfect match given the direct mapping from 'ads.ad_id'.
      - name: updated_at
        expression: ads._airbyte_extracted_at
        score: 1.0
        explanation: Standard 1.0 score for '_fivetran_synced' mapped to '_airbyte_extracted_at'.
      - name: adgroup_id
        expression: ads.adgroup_id
        score: 0.95
        explanation: "'ads.adgroup_id' aligns well with expectations."
      - name: advertiser_id
        expression: ads.advertiser_id
        score: 0.95
        explanation: "'ads.advertiser_id' aligns well with expectations."
      - name: campaign_id
        expression: ads.campaign_id
        score: 0.95
        explanation: "'ads.campaign_id' aligns well with expectations."
      - name: ad_name
        expression: ads.ad_name
        score: 1.0
        explanation: Directly maps from 'ads.ad_name' with high confidence.
      - name: ad_text
        expression: ads.ad_text
        score: 1.0
        explanation: Directly maps from 'ads.ad_text' with high confidence.
      - name: app_name
        expression: ads.app_name
        score: 1.0
        explanation: Directly maps from 'ads.app_name' with high confidence.
      - name: call_to_action
        expression: ads.call_to_action
        score: 1.0
        explanation: Directly maps from 'ads.call_to_action' with high confidence.
      - name: click_tracking_url
        expression: ads.click_tracking_url
        score: 1.0
        explanation: Directly maps from 'ads.click_tracking_url' with high confidence.
      - name: create_time
        expression: ads.create_time
        score: 0.9
        explanation: Most likely correct mapping but slight uncertainty.
      - name: display_name
        expression: ads.display_name
        score: 0.9
        explanation: Most likely correct mapping but slight uncertainty.
      - name: image_ids
        expression: ads.image_ids
        score: 0.9
        explanation: Most likely correct mapping but slight uncertainty.
      - name: impression_tracking_url
        expression: ads.impression_tracking_url
        score: 0.85
        explanation:
          Maps to 'ads.impression_tracking_url'; expression is detailed
          and consistent with ad-related data.
      - name: is_aco
        expression: ads.is_aco
        score: 0.9
        explanation: The mapping appears consistent with ad schema.
      - name: is_creative_authorized
        expression: ads.creative_authorized
        score: 0.85
        explanation: Mappings align, but US-specific context introduces slight uncertainty.
      - name: is_new_structure
        expression: ads.is_new_structure
        score: 0.85
        explanation: Limited by schema-specific context.
      - name: landing_page_url
        expression: ads.landing_page_url
        score: 1.0
        explanation: Direct mapping from 'ads.landing_page_url' is strong.
      - name: open_url
        expression: ads.deeplink
        score: 0.85
        explanation: Mapping exists but specifics vary, slightly lowering confidence.
      - name: opt_status
        expression: ads.operation_status
        score: 0.85
        explanation: Limited schema context slightly reduces confidence.
      - name: playable_url
        expression: ads.playable_url
        score: 1.0
        explanation: Strong mapping based on ad schema knowledge.
      - name: profile_image
        expression: ads.profile_image_url
        score: 1.0
        explanation: Direct mapping from 'ads.profile_image_url' matches perfectly.
      - name: status
        expression: ads.secondary_status
        score: 0.9
        explanation:
          Expected mapping from 'ads.secondary_status', but some schema
          variance may exist.
      - name: video_id
        expression: ads.video_id
        score: 1.0
        explanation: Direct mapping from 'ads.video_id' finely matches expectations.
