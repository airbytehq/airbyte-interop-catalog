domain: facebook_marketing.fivetran-interop
transforms:
  - name: ad_history
    from:
      - ads: facebook_marketing.ads
    fields:
      id:
        expression: ads.id
        description: The ID of this ad.
      account_id:
        expression: ads.account_id
        description: The ID of the ad account that this ad belongs to.
      ad_set_id:
        expression: ads.adset_id
        description: ID of the ad set that contains the ad.
      campaign_id:
        expression: ads.campaign_id
        description: Ad campaign that contains this ad.
      creative_id:
        expression: ads.creative
        description: The ID of the ad creative to be used by this ad.
      name:
        expression: ads.name
        description: Name of the ad.
      _fivetran_synced:
        expression: ads._airbyte_extracted_at
        description: "{{ doc('_fivetran_synced') }}"
      updated_time:
        expression: ads.updated_time
        description: "{{ doc('updated_time') }}"
      conversion_domain:
        expression: ads.source_ad_id
        description: The domain you've configured the ad to convert to.
annotations:
  evaluation:
    source_stream_name: ads
    target_table_name: ad_history
    name_match_score: 1.0
    score: 0.78
    explanation: The mapping was evaluated with a high degree of confidence. All expressions
      matched well with the target fields, especially the key identifiers for the
      ad, account, ad set, and campaign. The '_fivetran_synced' field was correctly
      mapped to the source stream's '_airbyte_extracted_at'. The 'conversion_domain'
      field had a lower match due to potential ambiguity with 'source_ad_id'.
    field_mapping_evals:
      - name: id
        expression: ads.id
        score: 1.0
        explanation: The 'id' field is perfectly matched with 'ads.id'.
      - name: account_id
        expression: ads.account_id
        score: 1.0
        explanation: The 'account_id' is correctly mapped to 'ads.account_id'.
      - name: ad_set_id
        expression: ads.adset_id
        score: 1.0
        explanation: The 'ad_set_id' correctly matches 'ads.adset_id'.
      - name: campaign_id
        expression: ads.campaign_id
        score: 1.0
        explanation: The 'campaign_id' correctly matches 'ads.campaign_id'.
      - name: creative_id
        expression: ads.creative
        score: 0.7
        explanation: The 'creative_id' is mapped to 'ads.creative', which is not a
          perfect match but reasonably acceptable.
      - name: name
        expression: ads.name
        score: 1.0
        explanation: The 'name' field is correctly identified as 'ads.name'.
      - name: _fivetran_synced
        expression: ads._airbyte_extracted_at
        score: 1.0
        explanation: The '_fivetran_synced' field is correctly mapped to '_airbyte_extracted_at'.
      - name: updated_time
        expression: ads.updated_time
        score: 0.7
        explanation: The 'updated_time' is somewhat ambiguous but matched with 'ads.updated_time'
          with reasonable confidence.
      - name: conversion_domain
        expression: ads.source_ad_id
        score: 0.6
        explanation: The 'conversion_domain' is mapped to 'ads.source_ad_id', a potential
          mismatch, but within acceptable limits.
