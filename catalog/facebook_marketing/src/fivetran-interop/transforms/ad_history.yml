domain: facebook_marketing.fivetran-interop
transforms:
  - name: ad_history
    from:
      - ads: facebook_marketing.ads
    fields:
      id:
        expression: ads.id
        description: The ID of this ad.
      account_id:
        expression: ads.account_id
        description: The ID of the ad account that this ad belongs to.
      ad_set_id:
        expression: ads.adset_id
        description: ID of the ad set that contains the ad.
      campaign_id:
        expression: ads.campaign_id
        description: Ad campaign that contains this ad.
      creative_id:
        expression: ads.creative.creative_id
        description: The ID of the ad creative to be used by this ad.
      name:
        expression: ads.name
        description: Name of the ad.
      _fivetran_synced:
        expression: ads._airbyte_extracted_at
        description: "{{ doc('_fivetran_synced') }}"
      updated_time:
        expression: ads.updated_time
        description: "{{ doc('updated_time') }}"
      conversion_domain:
        expression: MISSING
        description: The domain you've configured the ad to convert to.
annotations:
  approved: true
  missing_fields:
    - conversion_domain
  evaluation:
    source_stream_name: ads
    target_table_name: ad_history
    table_match_score: 0.8
    completion_score: 0.9
    explanation:
      The table mapping is highly confident; all fields except 'conversion_domain'
      are well-matched. Matches from source to target are clear and relevant.
    field_mapping_evals:
      - name: id
        expression: ads.id
        score: 1.0
        explanation: Exact match for 'id' field.
      - name: account_id
        expression: ads.account_id
        score: 1.0
        explanation: Exact match for 'account_id' field.
      - name: ad_set_id
        expression: ads.adset_id
        score: 1.0
        explanation: Exact match for 'ad_set_id' field.
      - name: campaign_id
        expression: ads.campaign_id
        score: 1.0
        explanation: Exact match for 'campaign_id' field.
      - name: creative_id
        expression: ads.creative.creative_id
        score: 1.0
        explanation: Exact match for 'creative_id' field.
      - name: name
        expression: ads.name
        score: 1.0
        explanation: Exact match for 'name' field.
      - name: _fivetran_synced
        expression: ads._airbyte_extracted_at
        score: 1.0
        explanation: Standard mapping of '_fivetran_synced' to '_airbyte_extracted_at'.
      - name: updated_time
        expression: ads.updated_time
        score: 1.0
        explanation: Exact match for 'updated_time' field.
      - name: conversion_domain
        expression: MISSING
        score: 0.0
        explanation: No good match found.
