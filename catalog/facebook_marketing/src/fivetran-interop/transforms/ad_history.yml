domain: facebook_marketing.fivetran-interop
transforms:
- display_name: Each record in this table reflects a version of a Facebook ad.
  id: ad_history
  from:
  - ads: airbyte_raw_facebook_marketing.ads
  - ad_creatives: airbyte_raw_facebook_marketing.ad_creatives
  fields:
    id:
      expression: ads.id
      description: The ID of this ad.
    account_id:
      expression: ads.account_id
      description: The ID of the ad account that this ad belongs to.
    ad_set_id:
      expression: ads.adset_id
      description: ID of the ad set that contains the ad.
    campaign_id:
      expression: ads.campaign_id
      description: Ad campaign that contains this ad.
    creative_id:
      expression: ads.creative.creative_id
      description: The ID of the ad creative to be used by this ad.
    name:
      expression: ads.name
      description: Name of the ad.
    _fivetran_synced:
      expression: ads._airbyte_extracted_at
      description: '{{ doc(''_fivetran_synced'') }}'
    updated_time:
      expression: ads.updated_time
      description: '{{ doc(''updated_time'') }}'
    conversion_domain:
      expression: "COALESCE(ad_creatives.object_story_link_data_link, ad_creatives.template_page_link, ad_creatives.page_link)"
      description: The domain you've configured the ad to convert to.
  
  unused_source_fields:
    - adlabels
    - bid_amount
    - bid_info
    - bid_type
    - created_time
    - effective_status
    - last_updated_by_app_id
    - recommendations
    - source_ad_id
    - status
    - targeting
    - tracking_specs
    - conversion_specs
    - creative.id
