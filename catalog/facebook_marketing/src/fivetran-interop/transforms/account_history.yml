domain: facebook_marketing.fivetran-interop
transforms:
  - name: account_history
    from:
      - ad_account: facebook_marketing.ad_account
    fields:
      id:
        expression: ad_account.id
        description: The ID of the ad account.
      name:
        expression: ad_account.name
        description: Name of the account.
      _fivetran_synced:
        expression: ad_account._airbyte_extracted_at
        description: "{{ doc('_fivetran_synced') }}"
      account_status:
        expression: ad_account.account_status
        description: Current status of account.
      business_country_code:
        expression: ad_account.business_country_code
        description: Country code of business associated to account.
      created_time:
        expression: ad_account.created_time
        description: The time account was created.
      currency:
        expression: ad_account.currency
        description: Currency associated with account.
      timezone_name:
        expression: ad_account.timezone_name
        description: Timezone associated with account.
annotations:
  approved: true
  missing_fields: []
  evaluation:
    source_stream_name: ad_account
    target_table_name: account_history
    table_match_score: 0.85
    completion_score: 0.9
    explanation:
      The table mapping is strong with most fields mapped accurately from
      source to target. Standard mappings and casing differences align correctly.
      No significant mismatches found that would lower confidence.
    field_mapping_evals:
      - name: id
        expression: ad_account.id
        score: 0.95
        explanation:
          Source field 'ad_account.id' matches closely with expected target
          field 'id'.
      - name: name
        expression: ad_account.name
        score: 0.95
        explanation:
          Source field 'ad_account.name' matches closely with expected
          target field 'name'.
      - name: _fivetran_synced
        expression: ad_account._airbyte_extracted_at
        score: 1.0
        explanation: Standard mapping of '_fivetran_synced' to 'ad_account._airbyte_extracted_at'.
      - name: account_status
        expression: ad_account.account_status
        score: 0.9
        explanation:
          The field 'ad_account.account_status' matches well with the target
          expectation of 'account_status'.
      - name: business_country_code
        expression: ad_account.business_country_code
        score: 0.9
        explanation:
          Field 'ad_account.business_country_code' has a high confidence
          mapping to 'business_country_code'.
      - name: created_time
        expression: ad_account.created_time
        score: 0.9
        explanation:
          Field 'ad_account.created_time' is expected to match the target
          'created_time' well.
      - name: currency
        expression: ad_account.currency
        score: 0.9
        explanation: The field 'ad_account.currency' maps confidently to 'currency'.
      - name: timezone_name
        expression: ad_account.timezone_name
        score: 0.9
        explanation:
          The source field 'ad_account.timezone_name' matches well with
          'timezone_name'.
