domain: facebook_marketing.fivetran-interop
transforms:
  - name: account_history
    from:
      - ad_account: facebook_marketing.ad_account
    fields:
      id:
        expression: ad_account.id
        description: The ID of the ad account.
      name:
        expression: ad_account.name
        description: Name of the account.
      _fivetran_synced:
        expression: ad_account._airbyte_extracted_at
        description: "{{ doc('_fivetran_synced') }}"
      account_status:
        expression: ad_account.account_status
        description: Current status of account.
      business_country_code:
        expression: ad_account.business_country_code
        description: Country code of business associated to account.
      created_time:
        expression: ad_account.created_time
        description: The time account was created.
      currency:
        expression: ad_account.currency
        description: Currency associated with account.
      timezone_name:
        expression: ad_account.timezone_name
        description: Timezone associated with account.
annotations:
  approved: true
  missing_fields: []
  evaluation:
    source_stream_name: ad_account
    target_table_name: account_history
    name_match_score: 0.9
    score: 0.85
    explanation:
      The overall confidence score reflects successful mappings of most
      fields with some confidence reduction due to possible discrepancies between
      field purposes.
    field_mapping_evals:
      - name: id
        expression: ad_account.id
        score: 0.95
        explanation: Strong match with ad_account.id.
      - name: name
        expression: ad_account.name
        score: 0.9
        explanation: Good match with ad_account.name.
      - name: _fivetran_synced
        expression: ad_account._airbyte_extracted_at
        score: 1.0
        explanation: Mapped successfully to the expected _airbyte_extracted_at field.
      - name: account_status
        expression: ad_account.account_status
        score: 0.8
        explanation: Reasonable match with ad_account.account_status.
      - name: business_country_code
        expression: ad_account.business_country_code
        score: 0.85
        explanation: Acceptable match with ad_account.business_country_code.
      - name: created_time
        expression: ad_account.created_time
        score: 0.9
        explanation: Good match with ad_account.created_time.
      - name: currency
        expression: ad_account.currency
        score: 0.75
        explanation: Moderate confidence due to possible currency format differences.
      - name: timezone_name
        expression: ad_account.timezone_name
        score: 0.7
        explanation: Potential mismatch due to timezone naming conventions.
