domain: facebook_marketing.fivetran-interop
transforms:
  - name: account_history
    from:
      - ad_account: facebook_marketing.ad_account
    fields:
      id:
        expression: ad_account.id
        description: The ID of the ad account.
      name:
        expression: ad_account.name
        description: Name of the account.
      _fivetran_synced:
        expression: ad_account._airbyte_extracted_at
        description: "{{ doc('_fivetran_synced') }}"
      account_status:
        expression: ad_account.account_status
        description: Current status of account.
      business_country_code:
        expression: ad_account.business_country_code
        description: Country code of business associated to account.
      created_time:
        expression: ad_account.created_time
        description: The time account was created.
      currency:
        expression: ad_account.currency
        description: Currency associated with account.
      timezone_name:
        expression: ad_account.timezone_name
        description: Timezone associated with account.
annotations:
  approved: true
  missing_fields: []
  evaluation:
    source_stream_name: ad_account
    target_table_name: account_history
    table_match_score: 0.8
    completion_score: 0.875
    explanation: The table mapping pertains to ad accounts which is consistent across
      both Airbyte and Fivetran schemas. Despite a high mapping quality with most
      fields expected to match in related contexts, certain fields might have missing,
      weak, or compounded matches causing slightly reduced confidence.
    field_mapping_evals:
      - name: id
        expression: ad_account.id
        score: 0.9
        explanation: IDs are usually direct matches and well understood, making them
          highly reliable for mapping.
      - name: name
        expression: ad_account.name
        score: 0.85
        explanation: Account names are straightforward and likely to map correctly,
          although context-specific variations may occur.
      - name: _fivetran_synced
        expression: ad_account._airbyte_extracted_at
        score: 1.0
        explanation: Standard mapping of '_fivetran_synced' to '_airbyte_extracted_at';
          always scores 1.00.
      - name: account_status
        expression: ad_account.account_status
        score: 0.75
        explanation: Account status is well-defined and normally matches, with a possibility
          of slight contextual variation.
      - name: business_country_code
        expression: ad_account.business_country_code
        score: 0.8
        explanation: Country codes are standardized well, but naming conventions may
          slightly affect mappings.
      - name: created_time
        expression: ad_account.created_time
        score: 0.8
        explanation: Creation times should map accurately, barring format discrepancies.
      - name: currency
        expression: ad_account.currency
        score: 0.7
        explanation: Currency codes typically match, but there can be minor variances
          in handling or naming.
      - name: timezone_name
        expression: ad_account.timezone_name
        score: 0.65
        explanation: Timezones generally correlate, but naming differences create
          minor uncertainties.
