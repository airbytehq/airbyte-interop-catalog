domain: facebook_marketing.fivetran-interop
transforms:
  - name: creative_history
    from:
      - ad_creatives: facebook_marketing.ad_creatives
    fields:
      _fivetran_id:
        expression: MISSING
        description: Unique record identifier
      page_link:
        expression: MISSING
        description: URL destination of Facebook ads.
      template_page_link:
        expression: MISSING
        description: URL destination of Facebook dynamic ads.
      id:
        expression: ad_creatives.id
        description: Unique ID for an ad creative.
      account_id:
        expression: ad_creatives.account_id
        description: Ad account ID for the account this ad creative belongs to.
      name:
        expression: ad_creatives.name
        description: Name of this ad creative as seen in the ad account's library.
      url_tags:
        expression: ad_creatives.url_tags
        description:
          A set of query string parameters which will replace or be appended
          to urls clicked from page post ads, message of the post, and canvas app
          install creatives only.
      _fivetran_synced:
        expression: ad_creatives._airbyte_extracted_at
        description: "{{ doc('_fivetran_synced') }}"
      asset_feed_spec_link_urls:
        expression: ad_creatives.asset_feed_spec.link_urls
        description: Link to the asset feed spec
      object_story_link_data_child_attachments:
        expression: ad_creatives.object_story_spec.link_data.child_attachments
        description: Link of the object story child attachments
      object_story_link_data_caption:
        expression: ad_creatives.object_story_spec.link_data.caption
        description: Link of the object story caption
      object_story_link_data_description:
        expression: ad_creatives.object_story_spec.link_data.description
        description: Link of the object story description
      object_story_link_data_link:
        expression: ad_creatives.object_story_spec.link_data.link
        description: Link of the object story link
      object_story_link_data_message:
        expression: ad_creatives.object_story_spec.link_data.message
        description: Link of the object story message
      template_app_link_spec_ios:
        expression: ad_creatives.object_story_spec.template_data.app_link_spec.ios
        description: Link of the object story spec for ios
      template_app_link_spec_ipad:
        expression: ad_creatives.object_story_spec.template_data.app_link_spec.ipad
        description: Link of the template app spec for ipad
      template_app_link_spec_android:
        expression: ad_creatives.object_story_spec.template_data.app_link_spec.android
        description: Link of the template app for android
      template_app_link_spec_iphone:
        expression: ad_creatives.object_story_spec.template_data.app_link_spec.iphone
        description: Link of the template app for iphone
annotations:
  approved: false
  missing_fields:
    - _fivetran_id
    - page_link
    - template_page_link
  evaluation:
    source_stream_name: ad_creatives
    target_table_name: creative_history
    table_match_score: 0.95
    completion_score: 0.82
    explanation:
      The table mappings are from similar source and target schemas with
      consistent subject matter. However, some fields were missing a good match. The
      table has a high match score due to strong alignment in identifiers and account
      fields, but completion is not perfect due to missing fields.
    field_mapping_evals:
      - name: _fivetran_id
        expression: MISSING
        score: 0.0
        explanation: No good match found.
      - name: page_link
        expression: MISSING
        score: 0.0
        explanation: No good match found.
      - name: template_page_link
        expression: MISSING
        score: 0.0
        explanation: No good match found.
      - name: id
        expression: ad_creatives.id
        score: 0.8
        explanation: Mapping is specific and contextually appropriate.
      - name: account_id
        expression: ad_creatives.account_id
        score: 0.8
        explanation: Mapping is specific and contextually appropriate.
      - name: name
        expression: ad_creatives.name
        score: 0.8
        explanation: Mapping is specific and contextually appropriate.
      - name: url_tags
        expression: ad_creatives.url_tags
        score: 0.8
        explanation: Mapping is specific and contextually appropriate.
      - name: _fivetran_synced
        expression: ad_creatives._airbyte_extracted_at
        score: 1.0
        explanation: Standard mapping for synchronization fields.
      - name: asset_feed_spec_link_urls
        expression: ad_creatives.asset_feed_spec.link_urls
        score: 0.5
        explanation: Possible match but not certain.
      - name: object_story_link_data_child_attachments
        expression: ad_creatives.object_story_spec.link_data.child_attachments
        score: 0.5
        explanation: Possible match but not certain.
      - name: object_story_link_data_caption
        expression: ad_creatives.object_story_spec.link_data.caption
        score: 0.5
        explanation: Possible match but not certain.
      - name: object_story_link_data_description
        expression: ad_creatives.object_story_spec.link_data.description
        score: 0.5
        explanation: Possible match but not certain.
      - name: object_story_link_data_link
        expression: ad_creatives.object_story_spec.link_data.link
        score: 0.5
        explanation: Possible match but not certain.
      - name: object_story_link_data_message
        expression: ad_creatives.object_story_spec.link_data.message
        score: 0.5
        explanation: Possible match but not certain.
      - name: template_app_link_spec_ios
        expression: ad_creatives.object_story_spec.template_data.app_link_spec.ios
        score: 0.5
        explanation: Possible match but not certain.
      - name: template_app_link_spec_ipad
        expression: ad_creatives.object_story_spec.template_data.app_link_spec.ipad
        score: 0.5
        explanation: Possible match but not certain.
      - name: template_app_link_spec_android
        expression: ad_creatives.object_story_spec.template_data.app_link_spec.android
        score: 0.5
        explanation: Possible match but not certain.
      - name: template_app_link_spec_iphone
        expression: ad_creatives.object_story_spec.template_data.app_link_spec.iphone
        score: 0.5
        explanation: Possible match but not certain.
