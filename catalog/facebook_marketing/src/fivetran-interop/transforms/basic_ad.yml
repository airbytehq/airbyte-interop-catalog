domain: facebook_marketing.fivetran-interop
transforms:
  - name: basic_ad
    from:
      - ads_insights: facebook_marketing.ads_insights
    fields:
      ad_id:
        expression: ads_insights.ad_id
        description: The ID of the ad the report relates to.
      ad_name:
        expression: ads_insights.ad_name
        description: Name of the ad the report relates to.
      adset_name:
        expression: MISSING
        description: Name of the ad set the report relates to.
      date:
        expression: MISSING
        description: The date of the reported performance.
      account_id:
        expression: ads_insights.account_id
        description: The ID of the ad account that this ad belongs to.
      impressions:
        expression: ads_insights.impressions
        description: The number of impressions the ad had on the given day.
      inline_link_clicks:
        expression: MISSING
        description: The number of clicks the ad had on the given day.
      spend:
        expression: ads_insights.spend
        description: The spend on the ad in the given day.
      reach:
        expression: ads_insights.reach
        description:
          The number of people who saw any content from your Page or about
          your Page. This metric is estimated.
      frequency:
        expression: ads_insights.frequency
        description:
          The average number of times each person saw your ad; it is calculated
          as impressions divided by reach.
      _fivetran_synced:
        expression: _airbyte_extracted_at
        description: "{{ doc('_fivetran_synced') }}"
annotations:
  approved: false
  missing_fields:
    - adset_name
    - date
    - inline_link_clicks
  evaluation:
    source_stream_name: ads_insights
    target_table_name: basic_ad
    name_match_score: 0.7
    score: 0.6
    explanation:
      The overall confidence score reflects the presence of several mappings
      that matched perfectly, while some were missing or partially incomplete.
    field_mapping_evals:
      - name: ad_id
        expression: ads_insights.ad_id
        score: 1.0
        explanation: Expression matches expected source column perfectly.
      - name: ad_name
        expression: ads_insights.ad_name
        score: 1.0
        explanation: Expression matches expected source column perfectly.
      - name: adset_name
        expression: MISSING
        score: 0.0
        explanation: The expression is MISSING for this field.
      - name: date
        expression: MISSING
        score: 0.0
        explanation: The expression is MISSING for this field.
      - name: account_id
        expression: ads_insights.account_id
        score: 1.0
        explanation: Expression matches expected source column perfectly.
      - name: impressions
        expression: ads_insights.impressions
        score: 1.0
        explanation: Expression matches expected source column perfectly.
      - name: inline_link_clicks
        expression: MISSING
        score: 0.0
        explanation: The expression is MISSING for this field.
      - name: spend
        expression: ads_insights.spend
        score: 1.0
        explanation: Expression matches expected source column perfectly.
      - name: reach
        expression: ads_insights.reach
        score: 1.0
        explanation: Expression matches expected source column perfectly.
      - name: frequency
        expression: ads_insights.frequency
        score: 1.0
        explanation: Expression matches expected source column perfectly.
      - name: _fivetran_synced
        expression: _airbyte_extracted_at
        score: 1.0
        explanation:
          Mapped to the source stream's '_airbyte_extracted_at' column
          as expected.
