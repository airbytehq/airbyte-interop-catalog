domain: facebook_marketing.fivetran-interop
transforms:
  - name: basic_ad
    from:
      - ads_insights: facebook_marketing.ads_insights
    fields:
      ad_id:
        expression: ads_insights.ad_id
        description: The ID of the ad the report relates to.
      ad_name:
        expression: ads_insights.ad_name
        description: Name of the ad the report relates to.
      adset_name:
        expression: ads_insights.adset_name
        description: Name of the ad set the report relates to.
      date:
        expression: ads_insights.date_start
        description: The date of the reported performance.
      account_id:
        expression: ads_insights.account_id
        description: The ID of the ad account that this ad belongs to.
      impressions:
        expression: ads_insights.impressions
        description: The number of impressions the ad had on the given day.
      inline_link_clicks:
        expression: ads_insights.inline_link_clicks
        description: The number of clicks the ad had on the given day.
      spend:
        expression: ads_insights.spend
        description: The spend on the ad in the given day.
      reach:
        expression: ads_insights.reach
        description:
          The number of people who saw any content from your Page or about
          your Page. This metric is estimated.
      frequency:
        expression: ads_insights.frequency
        description:
          The average number of times each person saw your ad; it is calculated
          as impressions divided by reach.
      _fivetran_synced:
        expression: ads_insights._airbyte_extracted_at
        description: "{{ doc('_fivetran_synced') }}"
annotations:
  approved: true
  missing_fields: []
  evaluation:
    source_stream_name: ads_insights
    target_table_name: basic_ad
    table_match_score: 0.9
    completion_score: 0.95
    explanation:
      The mapping is very comprehensive and the fields provided closely
      match the target schema. Most fields have a clear counterpart in the target
      schema, providing high confidence scores.
    field_mapping_evals:
      - name: ad_id
        expression: ads_insights.ad_id
        score: 1.0
        explanation: Exact match found for ad_id.
      - name: ad_name
        expression: ads_insights.ad_name
        score: 1.0
        explanation: Exact match found for ad_name.
      - name: adset_name
        expression: ads_insights.adset_name
        score: 1.0
        explanation: Exact match found for adset_name.
      - name: date
        expression: ads_insights.date_start
        score: 1.0
        explanation: Exact match found for date.
      - name: account_id
        expression: ads_insights.account_id
        score: 1.0
        explanation: Exact match found for account_id.
      - name: impressions
        expression: ads_insights.impressions
        score: 1.0
        explanation: Exact match found for impressions.
      - name: inline_link_clicks
        expression: ads_insights.inline_link_clicks
        score: 1.0
        explanation: Exact match found for inline_link_clicks.
      - name: spend
        expression: ads_insights.spend
        score: 1.0
        explanation: Exact match found for spend.
      - name: reach
        expression: ads_insights.reach
        score: 1.0
        explanation: Exact match found for reach.
      - name: frequency
        expression: ads_insights.frequency
        score: 1.0
        explanation: Exact match found for frequency.
      - name: _fivetran_synced
        expression: ads_insights._airbyte_extracted_at
        score: 1.0
        explanation: Mapped to _airbyte_extracted_at as per standard procedure.
