domain: shopify.fivetran-interop
transforms:
  - name: order_tag
    from:
      - order_risks: shopify.order_risks
    fields:
      _fivetran_synced:
        expression: order_risks._airbyte_extracted_at
        description: "{{ doc('_fivetran_synced') }}"
      index:
        expression: MISSING
        description:
          Index (starting from 1) represnting when the tag was placed on
          the order.
      order_id:
        expression: order_risks.order_id
        description: ID of the order being tagged.
      value:
        expression: MISSING
        description: Value of the tag.
annotations:
  approved: false
  missing_fields:
    - index
    - value
  evaluation:
    source_stream_name: order_risks
    target_table_name: order_tag
    name_match_score: 0.0
    score: 0.375
    explanation:
      The overall confidence score is a weighted average of individual
      field scores. '_fivetran_synced' has a strong mapping to '_airbyte_extracted_at'
      resulting in a high score. Other mappings have 'MISSING' expressions leading
      to zero confidence, lowering the average score significantly. The overall structure
      is plausible but has critical gaps due to incomplete mappings.
    field_mapping_evals:
      - name: _fivetran_synced
        expression: order_risks._airbyte_extracted_at
        score: 1.0
        explanation:
          "'_fivetran_synced' is correctly mapped to '_airbyte_extracted_at',
          following established best practices."
      - name: index
        expression: MISSING
        score: 0.0
        explanation:
          Mapping for 'index' is 'MISSING', resulting in zero confidence
          for this field.
      - name: order_id
        expression: order_risks.order_id
        score: 0.5
        explanation:
          Mapping for 'order_id' is plausible but not perfectly clear.
          Considered average confidence.
      - name: value
        expression: MISSING
        score: 0.0
        explanation:
          Mapping for 'value' is 'MISSING', leading to zero confidence
          for this field.
