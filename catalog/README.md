# Morph Catalog

This is a catalog of source and target schemas. Each connector follows a standard directory structure that facilitates the transformation of Airbyte source schemas into target schemas like Fivetran-compatible formats.

Assets in the catalog are a combination of:

- Airbyte source schema info, obtained from the connector's `schema` folder or via discovery.
- Target schemas, such as those we want to reshape our source data into.
- Generated files, file artifacts generated by our processes.

## Directory Structure

Using the Hubspot connector as an example, here's the standard directory structure for connectors in the catalog:

```
catalog/hubspot/
├── src/
│   └── transforms/
│       └── fivetran-interop/
│           ├── company.yml
│           ├── contact.yml
│       │   └── ...
├── requirements/
│   └── fivetran-interop/
│       └── src_hubspot.yml
├── generated/
│   ├── airbyte-catalog.json
│   ├── src_airbyte_hubspot.yml
│   └── dbt_project/
│       ├── models/
│       │   ├── contact.sql
│       │   ├── company.sql
│       │   └── ...
│       ├── dbt_project.yml
│       └── ...
└── examples/
    └── dbt_fivetran_compat/
        ├── README.md
        ├── dbt_project.yml
        ├── packages.yml
        └── ...
```

### Components

#### 1. `src/transforms/`

Contains YAML mapping files that define transformations from Airbyte source schemas to target schemas. Each mapping file:

- Defines the domain and transforms
- Specifies source tables in the `from` section
- Maps fields from source to target
- Provides descriptions for each field
- Documents unused source fields

Example from `contact.yml`:

```yaml
domain: hubspot.fivetran-interop
transforms:
  - display_name: Fivetran Raw 'Contact' Model
    id: contact
    from:
      - contacts: airbyte_raw_hubspot.contacts
    fields:
      _fivetran_deleted:
        expression: contacts.archived
        description: "Boolean to mark rows that were deleted in the source database."
      property_firstname:
        expression: contacts.properties_firstname
        description: "The first name of the contact."
      # ... other fields
```

#### 2. `requirements/`

Contains the target schema definitions that transformations should conform to. These files:

- Define the structure of the target schema
- Specify field names, types, and descriptions
- Serve as the reference for creating mapping files

#### 3. `generated/`

Contains files generated by the morph tool:

- `dbt_project/`: A complete dbt project with:
  - SQL models generated from mapping files
  - sources.yml defining the Airbyte source tables
  - dbt configuration files
- `airbyte-catalog.json`: The Airbyte catalog definition
- `src_airbyte_hubspot.yml`: The dbt source definition based on the Airbyte catalog

#### 4. `examples/`

Contains example projects demonstrating how to use the generated models:

- `dbt_fivetran_compat/`: An example dbt project that uses the generated models
- Configuration files showing how to integrate with existing dbt packages

## Adding a New Connector

Check the [Usage Guide Docs](../docs/USAGE.md) for information on creating and maintaining a new connector.
